/*!
 * jQuery AJAX Transport Middleware - v0.1.0 - 2013-03-04
 * https://github.com/kentfrazier/jquery-ajaxtransportmiddleware
 * Copyright (c) 2013 Kent Frazier; Licensed MIT
 */

(function(t,e){"use strict";"function"==typeof define&&define.amd?(define("_windowGlobal",[],function(){return e}),define(["jquery","_windowGlobal"],t)):t(jQuery,e)})(function(t,e,n){"use strict";function i(e){return function(i,r,a){return e._active&&(t.extend(!0,i,{_ajaxTransportMiddleware:{}}),!i._ajaxTransportMiddleware[e._id])?(i._ajaxTransportMiddleware[e._id]=!0,e.options.filter(i,r,a)?e.options.name:n):n}}function r(i){return function(r,a){function o(r,o){r=i.options.modifyHeaders(r),o=i.options.modifyCompleteCallback(o);var s={dataType:"text",converters:{"* text":e.String},global:!1,headers:r,statusCode:n,success:n,error:n,complete:function(t,e){o(t.status,e,{text:t.responseText},t.getAllResponseHeaders())}},d=t.extend(!0,{},a,s);u=jQuery.ajax(d)}function s(){u&&u.abort()}var u;return{send:o,abort:s}}}function a(e){this.options=t.extend(!0,{},s.DEFAULT_OPTIONS,e),this._id=d(),this.activate()}function o(e){u.add(e),t.ajaxPrefilter(e.dataTypes,i(e)),t.ajaxTransport(e.options.name,r(e))}function s(t){return new a(t)}var u={ids:{},names:{},add:t.proxy(function(t){var e=t._id,n=t.options.name;this.ids[e]=t,this.names[n]=this.names[n]||[],this.names[n].push(t)},u)},d=function(t){return function(){var e=""+t;return++t,e}}(t.now());return s.prototype={activate:function(){this._active=!0,this._id in u.ids||o(this)},deactivate:function(){this._active=!1},isActive:function(){return this._active},toString:function(){return["<ajaxTransportMiddleware: ",this.options.name,", ",this._id,">"].join("")}},t.extend(s,{DEFAULT_OPTIONS:{name:null,dataTypes:"*",filter:function(){return!0}},getByName:function(e,n){var i=[];if("*"===e)for(var r in u.names)u.names.hasOwnProperty(r)&&t.merge(i,this.getByName(r,n));else t.merge(i,u.names[e]||[]),i=t.grep(i,function(t){return n||t._active});return i}}),a.prototype=s.prototype,t.ajaxTransportMiddleware=s,s},this);