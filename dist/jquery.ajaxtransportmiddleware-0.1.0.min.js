/*!
 * jQuery AJAX Transport Middleware - v0.1.0 - 2013-03-06
 * https://github.com/kentfrazier/jquery-ajaxtransportmiddleware
 * Copyright (c) 2013 Kent Frazier; Licensed MIT
 */

(function(t,e){"use strict";"function"==typeof define&&define.amd?(define("_windowGlobal",[],function(){return e}),define(["jquery","_windowGlobal"],t)):t(jQuery,e)})(function(t,e){"use strict";function n(e){return function(n,i,a){return e.isActive()&&(t.extend(!0,n,{_ajaxTransportMiddleware:{}}),!n._ajaxTransportMiddleware[e.id])?(n._ajaxTransportMiddleware[e.id]=!0,e.options.filter(n,i,a)?e.dataType:undefined):undefined}}function i(n){return function(i,a){function r(r,o){o=n.options.completeCallbackWrapper(o,i,a);var u={dataType:"text",converters:{"* text":e.String},global:!1,headers:r,statusCode:null,success:null,error:null,complete:function(t,e){o(t.status,e,{text:t.responseText},t.getAllResponseHeaders())}};i.dataTypes.shift();var d=t.extend(!0,{},i,u);s=t.ajax(d)}function o(){s&&s.abort()}var s;return{send:r,abort:o}}}function a(e){this.options=t.extend(!0,{},o.DEFAULT_OPTIONS,e),this.name=this.options.name||null,this.id=u(),this.dataType=(this.name||this.id).toLowerCase(),this.activate()}function r(e){s.add(e),t.ajaxPrefilter(e.options.dataTypes,n(e)),t.ajaxTransport(e.dataType,i(e))}function o(t){return new a(t)}var s={ids:{},names:{},add:t.proxy(function(t){var e=t.id,n=t.name;this.ids[e]=t,this.names[n]=this.names[n]||[],this.names[n].push(t)},s)},u=function(t){return function(){var e=""+t;return++t,e}}(t.now());return o.prototype={activate:function(){this._active=!0,this.id in s.ids||r(this)},deactivate:function(){this._active=!1},isActive:function(){return this._active},toString:function(){return["<ajaxTransportMiddleware: ",this.dataType,", ",this.id,">"].join("")}},t.extend(o,{DEFAULT_OPTIONS:{name:null,dataTypes:"*",filter:function(){return!0},completeCallbackWrapper:function(t){return t}},getByName:function(e,n){var i=[];if("*"===e)for(var a in s.names)s.names.hasOwnProperty(a)&&t.merge(i,this.getByName(a,n));else t.merge(i,s.names[e]||[]),i=t.grep(i,function(t){return n||t._active});return i}}),a.prototype=o.prototype,t.ajaxTransportMiddleware=o,o},this);